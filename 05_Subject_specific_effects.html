<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="JoonHo Lee (jlee296@ua.edu)">
<meta name="author" content="Mehdi Rajeb">
<meta name="dcterms.date" content="2023-01-27">

<title>Chapter 5.Subject-specific effects, endogeneity, and unobserved confounding</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="05_Subject_specific_effects_files/libs/clipboard/clipboard.min.js"></script>
<script src="05_Subject_specific_effects_files/libs/quarto-html/quarto.js"></script>
<script src="05_Subject_specific_effects_files/libs/quarto-html/popper.min.js"></script>
<script src="05_Subject_specific_effects_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="05_Subject_specific_effects_files/libs/quarto-html/anchor.min.js"></script>
<link href="05_Subject_specific_effects_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="05_Subject_specific_effects_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="05_Subject_specific_effects_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="05_Subject_specific_effects_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="05_Subject_specific_effects_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Chapter 5.Subject-specific effects, endogeneity, and unobserved confounding</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>JoonHo Lee (jlee296@ua.edu) </p>
             <p>Mehdi Rajeb </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 27, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="introduction-5.1" class="level1">
<h1>Introduction (5.1)</h1>
<p>In this chapter, we discuss models with subject-specific effects (typically intercepts) when some of the covariates are correlated with some of the error terms. Such correlations are referred to as endogeneity in economics and as unobserved confounding in other fields, such as epidemiology. Many of the methods discussed in this chapter are from econometrics but are equally applicable in other fields that rely on nonexperimental data.</p>
<section id="data-used-in-this-chapter" class="level2">
<h2 class="anchored" data-anchor-id="data-used-in-this-chapter">Data used in this chapter</h2>
<p>In most of this chapter, we used the wage-panel data. Let us get some idea about the data set first.</p>
<p>Let us have a look at the variables in the the wage-panel data.</p>
<ul>
<li><p><code>nr</code>: person identifier (<span class="math inline">\(j\)</span>)</p></li>
<li><p><code>lwage</code>: log hourly wage in U.S. dollars (<span class="math inline">\(y_{ij}\)</span>)</p></li>
<li><p>Race/ Ethnicity (reference category is White)</p>
<ul>
<li><p><code>black</code> : dummy variable for being Black (<span class="math inline">\(x_{2j}\)</span>)</p></li>
<li><p><code>hisp</code>: dummy variable for being Hispanic(<span class="math inline">\(x_{3j}\)</span>)</p></li>
</ul></li>
<li><p><code>union</code>: dummy variable for being a member of a union (that is, wage being set in collective bargaining agreement) (<span class="math inline">\(x_{4ij}\)</span>)</p></li>
<li><p><code>married</code> : dummy variable for being married (<span class="math inline">\(x_{5ij}\)</span>)</p></li>
<li><p><code>exper</code>: labor-market experience, defined as age-6- educ(<span class="math inline">\(L_{ij}\)</span>)</p></li>
<li><p><code>year</code>: calendar year 1980-1987(<span class="math inline">\(P_i\)</span>)</p></li>
<li><p><code>educ</code> : years of schooling (<span class="math inline">\(E_j\)</span>)</p></li>
</ul>
<p>Let us import the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let us get the wagepan data loaded in R</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="st">"wagepan.dta"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># let us have a look at the data.</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span> <span class="fu">kable</span>(<span class="fu">head</span>(df))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 3%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 1%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 3%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">nr</th>
<th style="text-align: right;">year</th>
<th style="text-align: right;">agric</th>
<th style="text-align: right;">black</th>
<th style="text-align: right;">bus</th>
<th style="text-align: right;">construc</th>
<th style="text-align: right;">ent</th>
<th style="text-align: right;">exper</th>
<th style="text-align: right;">fin</th>
<th style="text-align: right;">hisp</th>
<th style="text-align: right;">poorhlth</th>
<th style="text-align: right;">hours</th>
<th style="text-align: right;">manuf</th>
<th style="text-align: right;">married</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">nrthcen</th>
<th style="text-align: right;">nrtheast</th>
<th style="text-align: right;">occ1</th>
<th style="text-align: right;">occ2</th>
<th style="text-align: right;">occ3</th>
<th style="text-align: right;">occ4</th>
<th style="text-align: right;">occ5</th>
<th style="text-align: right;">occ6</th>
<th style="text-align: right;">occ7</th>
<th style="text-align: right;">occ8</th>
<th style="text-align: right;">occ9</th>
<th style="text-align: right;">per</th>
<th style="text-align: right;">pro</th>
<th style="text-align: right;">pub</th>
<th style="text-align: right;">rur</th>
<th style="text-align: right;">south</th>
<th style="text-align: right;">educ</th>
<th style="text-align: right;">tra</th>
<th style="text-align: right;">trad</th>
<th style="text-align: right;">union</th>
<th style="text-align: right;">lwage</th>
<th style="text-align: right;">d81</th>
<th style="text-align: right;">d82</th>
<th style="text-align: right;">d83</th>
<th style="text-align: right;">d84</th>
<th style="text-align: right;">d85</th>
<th style="text-align: right;">d86</th>
<th style="text-align: right;">d87</th>
<th style="text-align: right;">expersq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: right;">1980</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2672</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.197540</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td style="text-align: right;">1981</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2320</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.853060</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: right;">1982</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2940</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.344462</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td style="text-align: right;">1983</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2960</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.433213</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">16</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: right;">1984</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3071</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.568125</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td style="text-align: right;">1985</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2864</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.699891</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">36</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Also let us construct two required variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we need to construct two new variables, educt and yeart</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>educt <span class="ot">&lt;-</span> df<span class="sc">$</span>educ <span class="sc">-</span> <span class="dv">12</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>yeart<span class="ot">&lt;-</span> df<span class="sc">$</span>year<span class="dv">-1980</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># let us have a look at the data.</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(df))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 3%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 1%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 2%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">nr</th>
<th style="text-align: right;">year</th>
<th style="text-align: right;">agric</th>
<th style="text-align: right;">black</th>
<th style="text-align: right;">bus</th>
<th style="text-align: right;">construc</th>
<th style="text-align: right;">ent</th>
<th style="text-align: right;">exper</th>
<th style="text-align: right;">fin</th>
<th style="text-align: right;">hisp</th>
<th style="text-align: right;">poorhlth</th>
<th style="text-align: right;">hours</th>
<th style="text-align: right;">manuf</th>
<th style="text-align: right;">married</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">nrthcen</th>
<th style="text-align: right;">nrtheast</th>
<th style="text-align: right;">occ1</th>
<th style="text-align: right;">occ2</th>
<th style="text-align: right;">occ3</th>
<th style="text-align: right;">occ4</th>
<th style="text-align: right;">occ5</th>
<th style="text-align: right;">occ6</th>
<th style="text-align: right;">occ7</th>
<th style="text-align: right;">occ8</th>
<th style="text-align: right;">occ9</th>
<th style="text-align: right;">per</th>
<th style="text-align: right;">pro</th>
<th style="text-align: right;">pub</th>
<th style="text-align: right;">rur</th>
<th style="text-align: right;">south</th>
<th style="text-align: right;">educ</th>
<th style="text-align: right;">tra</th>
<th style="text-align: right;">trad</th>
<th style="text-align: right;">union</th>
<th style="text-align: right;">lwage</th>
<th style="text-align: right;">d81</th>
<th style="text-align: right;">d82</th>
<th style="text-align: right;">d83</th>
<th style="text-align: right;">d84</th>
<th style="text-align: right;">d85</th>
<th style="text-align: right;">d86</th>
<th style="text-align: right;">d87</th>
<th style="text-align: right;">expersq</th>
<th style="text-align: right;">educt</th>
<th style="text-align: right;">yeart</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: right;">1980</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2672</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.197540</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td style="text-align: right;">1981</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2320</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.853060</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: right;">1982</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2940</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.344462</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td style="text-align: right;">1983</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2960</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.433213</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: right;">1984</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3071</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.568125</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td style="text-align: right;">1985</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2864</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.699891</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="random-effects-approach-no-endogeneity-5.2" class="level2">
<h2 class="anchored" data-anchor-id="random-effects-approach-no-endogeneity-5.2">Random-effects approach: No endogeneity (5.2)</h2>
<p>Following econometric practice, let us estimate the random-effect model for each participants. In this segment, we will use <code>R-PLM</code> package for estimating various models.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Random effect model with lwage as the dependent variable, and nr as the grouping variable with FGLS method.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># To estimate the model, we will use `PLM` R-package. </span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>mod_1<span class="ot">&lt;-</span> <span class="fu">plm</span>(lwage <span class="sc">~</span> black <span class="sc">+</span> hisp<span class="sc">+</span> union <span class="sc">+</span> married <span class="sc">+</span> exper <span class="sc">+</span> yeart <span class="sc">+</span>educt, </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> df, </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">model =</span> <span class="st">"random"</span>, </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"nr"</span>),</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">effect=</span> <span class="st">"individual"</span>, </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"fgls"</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Let us have a look at the estimates</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Oneway (individual) effect Random Effect Model 
   (Swamy-Arora's transformation)

Call:
plm(formula = lwage ~ black + hisp + union + married + exper + 
    yeart + educt, data = df, effect = "individual", model = "random", 
    index = c("nr"), method = "fgls")

Balanced Panel: n = 545, T = 8, N = 4360

Effects:
                 var std.dev share
idiosyncratic 0.1250  0.3535 0.542
individual    0.1055  0.3248 0.458
theta: 0.6408

Residuals:
     Min.   1st Qu.    Median   3rd Qu.      Max. 
-4.558024 -0.143131  0.025256  0.191659  1.541246 

Coefficients:
             Estimate Std. Error z-value  Pr(&gt;|z|)    
(Intercept)  1.317105   0.037240 35.3683 &lt; 2.2e-16 ***
black       -0.133860   0.047737 -2.8041  0.005046 ** 
hisp         0.017403   0.042619  0.4083  0.683027    
union        0.110880   0.017914  6.1894 6.038e-10 ***
married      0.075517   0.016746  4.5096 6.495e-06 ***
exper        0.033148   0.011151  2.9725  0.002954 ** 
yeart        0.025917   0.011357  2.2820  0.022492 *  
educt        0.094679   0.010656  8.8852 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    657.77
Residual Sum of Squares: 545.73
R-Squared:      0.17033
Adj. R-Squared: 0.169
Chisq: 893.471 on 7 DF, p-value: &lt; 2.22e-16</code></pre>
</div>
</div>
<p>The <code>mod_1</code> estimates are providing general standard error estimates. Let us convert the standard errors to Robust standard error.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># However, mod_1 will not provide estimates with robust standard error.</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># To obtain the estimates with robust standard error, we need to run an additional function. </span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>mod_2<span class="ot">&lt;-</span> <span class="fu">coeftest</span>(mod_1, </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov.=</span><span class="cf">function</span>(x)<span class="fu">vcovHC</span>(x, <span class="at">type =</span><span class="st">'sss'</span>))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># let us have a look at the estimates.</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>mod_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
t test of coefficients:

             Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept)  1.317105   0.039535 33.3151 &lt; 2.2e-16 ***
black       -0.133860   0.050596 -2.6456  0.008183 ** 
hisp         0.017403   0.039244  0.4435  0.657458    
union        0.110880   0.021094  5.2566 1.538e-07 ***
married      0.075517   0.018993  3.9760 7.122e-05 ***
exper        0.033148   0.011205  2.9582  0.003111 ** 
yeart        0.025917   0.011759  2.2039  0.027580 *  
educt        0.094679   0.011060  8.5601 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="fixed-effects-approach-level-2-endogeneity-5.3" class="level2">
<h2 class="anchored" data-anchor-id="fixed-effects-approach-level-2-endogeneity-5.3">Fixed-effects approach: Level-2 endogeneity (5.3)</h2>
<p>If there is level-2 endogeneity, random-effects estimators are inconsistent. This problem could be due to unobserved subject-level confounding, where omitted time-constant covariates are correlated with the included covariates. To handle the problem, fixed-effects approaches are often used that produce estimates of the coefficients of level-1 covariates but not of level-2 covariates.</p>
<section id="de-meaning-and-subject-dummies-5.3.1" class="level3">
<h3 class="anchored" data-anchor-id="de-meaning-and-subject-dummies-5.3.1">De-meaning and subject dummies (5.3.1)</h3>
<p><strong>De-meaning</strong></p>
<p>Estimating fixed effect model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Let us estimate the fixed-effects within subject regression</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#To estimate the model we are using PLM R-package. </span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>mod_3<span class="ot">&lt;-</span><span class="fu">plm</span>(lwage <span class="sc">~</span>  union <span class="sc">+</span> married <span class="sc">+</span> exper <span class="sc">+</span> yeart , </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> df, </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">model =</span> <span class="st">"within"</span>, </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"nr"</span>),</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">effect=</span> <span class="st">"individual"</span>, </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"fe"</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Let us have a look at the estimates</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Oneway (individual) effect Within Model

Call:
plm(formula = lwage ~ union + married + exper + yeart, data = df, 
    effect = "individual", model = "within", index = c("nr"), 
    method = "fe")

Balanced Panel: n = 545, T = 8, N = 4360

Residuals:
    Min.  1st Qu.   Median  3rd Qu.     Max. 
-4.14628 -0.12503  0.01232  0.16205  1.48094 

Coefficients: (1 dropped because of singularities)
         Estimate Std. Error t-value  Pr(&gt;|t|)    
union   0.0837910  0.0194140  4.3160 1.629e-05 ***
married 0.0610384  0.0182929  3.3367 0.0008558 ***
exper   0.0598672  0.0025835 23.1726 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    572.05
Residual Sum of Squares: 476.43
R-Squared:      0.16715
Adj. R-Squared: 0.047646
F-statistic: 255.026 on 3 and 3812 DF, p-value: &lt; 2.22e-16</code></pre>
</div>
</div>
<p>The error estimates in the previous fixed-effect model are not robust. To estimate the robust standard errors, we need to run additional codes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let us use the following code to obtain the robus standard errors.</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>mod_4<span class="ot">&lt;-</span> <span class="fu">coeftest</span>(mod_3, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov.=</span><span class="cf">function</span>(x)<span class="fu">vcovHC</span>(x, <span class="at">type =</span><span class="st">'sss'</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                 )</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Let us have a look at the estimates now. </span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>mod_4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
t test of coefficients:

         Estimate Std. Error t value  Pr(&gt;|t|)    
union   0.0837910  0.0231074  3.6262 0.0002914 ***
married 0.0610384  0.0212051  2.8785 0.0040183 ** 
exper   0.0598672  0.0033713 17.7578 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>All the estimates are reported under “De-meaning” in table 5.2.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="table5.2.jpg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption"><strong>Table 5.2</strong>: Estimates for subject-specific models for wage-panel data.</figcaption><p></p>
</figure>
</div>
</section>
</section>
<section id="hausman-test5.3.2" class="level2">
<h2 class="anchored" data-anchor-id="hausman-test5.3.2">Hausman test(5.3.2)</h2>
<p>The Hausman test can be used to investigate level-2 endogeneity of the time-varying covariates by comparing fixed-effects and random effects estimators of their coefficients. The Hausman test will compare the coefficients of all time-varying covariates, including <code>exper</code>, and will not “know” that the coefficients have different meanings, or that their true values are different. We can prevent the <code>Hausman test</code> from comparing the coefficients of <code>exper</code> by using a different variable named <code>exper_copy</code> in one of the models.</p>
<p>So let us create a copy of the <code>exper</code> variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a copy of exper variable</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">exper_copy =</span> exper</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we refit the random-intercept model with this new variable name (instead of <code>exper</code>),and store the model under ri.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We are estimating the random-effects model using PLM package</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>ri<span class="ot">&lt;-</span> <span class="fu">plm</span>(lwage <span class="sc">~</span>  black<span class="sc">+</span>hisp<span class="sc">+</span> union<span class="sc">+</span>married <span class="sc">+</span> exper_copy<span class="sc">+</span> yeart<span class="sc">+</span>educt , </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> df, </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">model =</span><span class="st">"random"</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">method =</span> <span class="st">"re"</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># let us have a look at the estimated coefficients</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>ri_coeff<span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(ri<span class="sc">$</span>coefficients)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>ri_coeff</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            ri$coefficients
(Intercept)      1.31710463
black           -0.13385951
hisp             0.01740292
union            0.11087978
married          0.07551705
exper_copy       0.03314771
yeart            0.02591660
educt            0.09467904</code></pre>
</div>
</div>
<p>Note that we have used model-based standard error. We also refit the fixed-effects model with model-based standard errors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We are estimating the random-effects model using PLM package</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>fi<span class="ot">&lt;-</span> <span class="fu">plm</span>(lwage <span class="sc">~</span>  union<span class="sc">+</span> married <span class="sc">+</span> exper,  </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> df, </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">model=</span> <span class="st">"within"</span>, </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">method =</span> <span class="st">"fe"</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># let us have a look at the estimated coefficients</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>fi_coeff<span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(fi<span class="sc">$</span>coefficients)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>fi_coeff</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        fi$coefficients
union        0.08379095
married      0.06103842
exper        0.05986722</code></pre>
</div>
</div>
<p>We are now ready to perform the <code>Hausman test</code> using the <code>plm::phtest()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To perform Hausman test, we can use the following command comparing random effect and fixed effect models. </span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>plm<span class="sc">::</span><span class="fu">phtest</span>(fi,ri)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Hausman Test

data:  lwage ~ union + married + exper
chisq = 16.734, df = 2, p-value = 0.0002324
alternative hypothesis: one model is inconsistent</code></pre>
</div>
</div>
<p>We conclude from the output that the fixed and random-effects approaches produce significantly different estimates, which suggests that <code>union</code>and/or <code>married</code> are level-2 endogenous.</p>
</section>
<section id="mundlak-approach-and-robust-hausman-test-5.3.3" class="level2">
<h2 class="anchored" data-anchor-id="mundlak-approach-and-robust-hausman-test-5.3.3">Mundlak approach and robust Hausman test (5.3.3)</h2>
<p>We first construct the required subject means to be included in the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generating mean of Union and married.</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># mn_union = mean of union</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># mn_married = mean of married</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(nr) <span class="sc">%&gt;%</span> </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mn_union =</span> <span class="fu">mean</span>(union, <span class="at">na.rm =</span> T), </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">mn_married =</span> <span class="fu">mean</span>(married, <span class="at">na.rm=</span>T)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 49
# Groups:   nr [1]
     nr  year agric black   bus construc   ent exper   fin  hisp poorhlth hours
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;
1    13  1980     0     0     1        0     0     1     0     0        0  2672
2    13  1981     0     0     0        0     0     2     0     0        0  2320
3    13  1982     0     0     1        0     0     3     0     0        0  2940
4    13  1983     0     0     1        0     0     4     0     0        0  2960
5    13  1984     0     0     0        0     0     5     0     0        0  3071
6    13  1985     0     0     1        0     0     6     0     0        0  2864
# … with 37 more variables: manuf &lt;dbl&gt;, married &lt;dbl&gt;, min &lt;dbl&gt;,
#   nrthcen &lt;dbl&gt;, nrtheast &lt;dbl&gt;, occ1 &lt;dbl&gt;, occ2 &lt;dbl&gt;, occ3 &lt;dbl&gt;,
#   occ4 &lt;dbl&gt;, occ5 &lt;dbl&gt;, occ6 &lt;dbl&gt;, occ7 &lt;dbl&gt;, occ8 &lt;dbl&gt;, occ9 &lt;dbl&gt;,
#   per &lt;dbl&gt;, pro &lt;dbl&gt;, pub &lt;dbl&gt;, rur &lt;dbl&gt;, south &lt;dbl&gt;, educ &lt;dbl&gt;,
#   tra &lt;dbl&gt;, trad &lt;dbl&gt;, union &lt;dbl&gt;, lwage &lt;dbl&gt;, d81 &lt;dbl&gt;, d82 &lt;dbl&gt;,
#   d83 &lt;dbl&gt;, d84 &lt;dbl&gt;, d85 &lt;dbl&gt;, d86 &lt;dbl&gt;, d87 &lt;dbl&gt;, expersq &lt;dbl&gt;,
#   educt &lt;dbl&gt;, yeart &lt;dbl&gt;, exper_copy &lt;dbl&gt;, mn_union &lt;dbl&gt;, …</code></pre>
</div>
</div>
<p>Now we fit the random effect model with robust standard error.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To estimate the random effect model, we will use the PLM R-package.</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We may not be able to estimate the random effect model with robust standard error directly in R. </span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>model_formula <span class="ot">&lt;-</span> lwage <span class="sc">~</span> black <span class="sc">+</span> hisp<span class="sc">+</span> union <span class="sc">+</span> married <span class="sc">+</span> exper <span class="sc">+</span> yeart <span class="sc">+</span> educt <span class="sc">+</span> mn_union <span class="sc">+</span> mn_married</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>model_5<span class="ot">&lt;-</span> <span class="fu">plm</span>( model_formula, </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> df, </span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">model =</span> <span class="fu">c</span>(<span class="st">"random"</span>),</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"nr"</span>),</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">effect=</span> <span class="st">"individual"</span>, </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">method =</span> <span class="st">"fgls"</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Let us have a look at model_5</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Oneway (individual) effect Random Effect Model 
   (Swamy-Arora's transformation)

Call:
plm(formula = model_formula, data = df, effect = "individual", 
    model = c("random"), index = c("nr"), method = "fgls")

Balanced Panel: n = 545, T = 8, N = 4360

Effects:
                 var std.dev share
idiosyncratic 0.1250  0.3535 0.542
individual    0.1055  0.3248 0.458
theta: 0.6408

Residuals:
     Min.   1st Qu.    Median   3rd Qu.      Max. 
-4.536201 -0.146105  0.025327  0.189864  1.552005 

Coefficients:
             Estimate Std. Error z-value  Pr(&gt;|z|)    
(Intercept)  1.266503   0.039978 31.6800 &lt; 2.2e-16 ***
black       -0.141431   0.048913 -2.8915 0.0038346 ** 
hisp         0.010039   0.042626  0.2355 0.8138153    
union        0.083791   0.019414  4.3160 1.589e-05 ***
married      0.061038   0.018293  3.3367 0.0008477 ***
exper        0.027812   0.011334  2.4538 0.0141337 *  
yeart        0.032055   0.011625  2.7574 0.0058258 ** 
educt        0.091261   0.010717  8.5159 &lt; 2.2e-16 ***
mn_union     0.174925   0.049950  3.5020 0.0004618 ***
mn_married   0.080597   0.045113  1.7866 0.0740075 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    657.77
Residual Sum of Squares: 543.67
R-Squared:      0.17346
Adj. R-Squared: 0.17175
Chisq: 912.878 on 9 DF, p-value: &lt; 2.22e-16</code></pre>
</div>
</div>
<p>We need to further transform the error to achieve estimates with robust standard error.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># After estimating the model_5, we can re-estimate the model with robust standard error.</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>model_5_rse<span class="ot">&lt;-</span> <span class="fu">coeftest</span>(model_5, </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">vcov.=</span><span class="cf">function</span>(x)<span class="fu">vcovHC</span>(x, <span class="at">type =</span><span class="st">'sss'</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>                       )</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>model_5_rse</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
t test of coefficients:

             Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept)  1.266503   0.042564 29.7555 &lt; 2.2e-16 ***
black       -0.141431   0.050912 -2.7779 0.0054939 ** 
hisp         0.010039   0.038500  0.2607 0.7942985    
union        0.083791   0.023126  3.6232 0.0002943 ***
married      0.061038   0.021222  2.8762 0.0040450 ** 
exper        0.027812   0.011330  2.4548 0.0141342 *  
yeart        0.032055   0.011976  2.6766 0.0074652 ** 
educt        0.091261   0.011161  8.1765 3.795e-16 ***
mn_union     0.174925   0.047458  3.6859 0.0002307 ***
mn_married   0.080597   0.045294  1.7794 0.0752423 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>As expected, the point estimates for <code>union</code>, <code>married</code>, and <code>exper</code> are identical to the fixed-effects estimates. Robust standard errors were used to obtain valid inferences if the covariance structure is misspecified, for example if the level-1 errors are autocorrelated or heteroskedastic.</p>
</section>
<section id="first-differencing-5.3.4" class="level2">
<h2 class="anchored" data-anchor-id="first-differencing-5.3.4">First-differencing (5.3.4)</h2>
<p>The three fixed-effects approaches discussed so far (de-meaning, subject dummies,and Mundlak) produce identical estimators of the coefficients of time-varying covariates, often referred to as the fixed-effects estimator in econometrics. A fourth approach that also handles level-2 endogeneity is the difference estimator .</p>
<p>To use the time-series operations, we can use the <code>PLM</code> R-package defining the model as first difference model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Linear regression using first difference</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>model_6<span class="ot">&lt;-</span> <span class="fu">plm</span>(lwage <span class="sc">~</span>  union <span class="sc">+</span> married, </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> df, </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">model =</span> <span class="st">"fd"</span>, </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"nr"</span>),</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">effect=</span> <span class="st">"individual"</span>, </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">method =</span><span class="st">"fgls"</span>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Oneway (individual) effect First-Difference Model

Call:
plm(formula = lwage ~ union + married, data = df, effect = "individual", 
    model = "fd", index = c("nr"), method = "fgls")

Balanced Panel: n = 545, T = 8, N = 4360
Observations used in estimation: 3815

Residuals:
     Min.   1st Qu.    Median   3rd Qu.      Max. 
-4.575660 -0.145561 -0.014871  0.132665  4.836975 

Coefficients:
             Estimate Std. Error t-value Pr(&gt;|t|)    
(Intercept) 0.0648596  0.0073152  8.8664  &lt; 2e-16 ***
union       0.0424063  0.0196746  2.1554  0.03119 *  
married     0.0431299  0.0228794  1.8851  0.05949 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    751.19
Residual Sum of Squares: 749.58
R-Squared:      0.0021542
Adj. R-Squared: 0.0016307
F-statistic: 4.11486 on 2 and 3812 DF, p-value: 0.016401</code></pre>
</div>
</div>
<p>The model is estimated based on the first differences. However, the standard model errors were estimated in this case. If we wish to estimate the robust standard error, we may use the following R-code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First difference model coefficients with robust standard error</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(model_6, </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">vcov.=</span><span class="cf">function</span>(x)<span class="fu">vcovHC</span>(x, <span class="at">type =</span><span class="st">'sss'</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>         )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
t test of coefficients:

             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 0.0648596  0.0037943  17.094  &lt; 2e-16 ***
union       0.0424063  0.0220173   1.926  0.05417 .  
married     0.0431299  0.0242172   1.781  0.07500 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="difference-in-differences-and-repeated-measure-anova-5.4" class="level2">
<h2 class="anchored" data-anchor-id="difference-in-differences-and-repeated-measure-anova-5.4">Difference-in differences and repeated-measure ANOVA (5.4)</h2>
</section>
<section id="does-raising-the-minimum-wage-reduce-employment" class="level2">
<h2 class="anchored" data-anchor-id="does-raising-the-minimum-wage-reduce-employment">Does raising the minimum wage reduce employment?</h2>
<p>According to economic theory, increases in minimum wage should lead to decreased employment because labor becomes more expensive.Here we analyze data from the classic paper by <span class="citation" data-cites="card1994american">@card1994american</span>. The data is called <code>minwage</code>, and has following variables of our interest.</p>
<ul>
<li><p><code>store</code> : restaurant or store identifier</p></li>
<li><p><code>post</code>: dummy variable for post-intervention survey wave(0= pre, 1=post)</p></li>
<li><p><code>state</code> : State(0 = PA, 1 = NJ)</p></li>
<li><p><code>fte</code> : number of full-time employees</p></li>
</ul>
<p>Let us read the data using <code>read_dta</code> R-function from <code>haven</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importing minwage data</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co"># we are naming the data as df_mw. here, mw stands for mean wage. </span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>df_mw<span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="st">"minwage.dta"</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Let us have a look at the data</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_mw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 33
  store  post chain     co_owned state   southJ centr…¹ northJ   PA1   PA2 shore
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl+lbl&gt;    &lt;dbl&gt; &lt;dbl+l&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     1     0 1 [BK]           0 1 [NJ]       0       1      0     0     0     0
2     1     1 1 [BK]           0 1 [NJ]       0       1      0     0     0     0
3     2     0 1 [BK]           0 1 [NJ]       0       1      0     0     0     0
4     2     1 1 [BK]           0 1 [NJ]       0       1      0     0     0     0
5     3     0 2 [KFC]          0 1 [NJ]       0       1      0     0     0     0
6     3     1 2 [KFC]          0 1 [NJ]       0       1      0     0     0     0
# … with 22 more variables: bonus &lt;dbl&gt;, pct_aff &lt;dbl&gt;, type2 &lt;dbl&gt;,
#   status2 &lt;dbl+lbl&gt;, date2 &lt;dbl&gt;, n_calls &lt;dbl&gt;, emp_ft &lt;dbl&gt;, emp_pt &lt;dbl&gt;,
#   n_managers &lt;dbl&gt;, wage_start &lt;dbl&gt;, inctime &lt;dbl&gt;, first_inc &lt;dbl&gt;,
#   special &lt;dbl&gt;, meals &lt;dbl&gt;, open &lt;dbl&gt;, hrs_open &lt;dbl&gt;, p_soda &lt;dbl&gt;,
#   p_fry &lt;dbl&gt;, p_entree &lt;dbl&gt;, n_regs &lt;dbl&gt;, n_regs11 &lt;dbl&gt;, fte &lt;dbl&gt;, and
#   abbreviated variable name ¹​centralJ</code></pre>
</div>
</div>
<p>To perform our next analysis, let us construct the interaction variable <code>treated</code> which can be interpreted as a time-varying dummy variable for treatment status (minimum wage increased or not)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating variable `treated`</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>df_mw<span class="ot">&lt;-</span>df_mw <span class="sc">%&gt;%</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">treated =</span> state<span class="sc">*</span>post)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, we estimate both the random and fixed effect models using the <code>minwage</code> data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Model estimation. </span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>model_7<span class="ot">&lt;-</span> <span class="fu">plm</span>(fte <span class="sc">~</span>  post <span class="sc">+</span> treated, </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> df_mw, </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">model =</span> <span class="st">"within"</span>, </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"store"</span>),</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">effect=</span> <span class="st">"individual"</span>, </span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">method =</span><span class="st">"re"</span>)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_7)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Oneway (individual) effect Within Model

Call:
plm(formula = fte ~ post + treated, data = df_mw, effect = "individual", 
    model = "within", index = c("store"), method = "re")

Unbalanced Panel: n = 410, T = 1-2, N = 794

Residuals:
    Min.  1st Qu.   Median  3rd Qu.     Max. 
-19.6083  -1.9833   0.0000   1.9833  19.6083 

Coefficients:
        Estimate Std. Error t-value Pr(&gt;|t|)  
post     -2.2833     1.0355 -2.2050  0.02805 *
treated   2.7500     1.1544  2.3823  0.01769 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    15590
Residual Sum of Squares: 15360
R-Squared:      0.014699
Adj. R-Squared: -1.0454
F-statistic: 2.84948 on 2 and 382 DF, p-value: 0.059105</code></pre>
</div>
</div>
<p>To obtain the robust standard errors, we have to use the following codes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimates with robust standard error</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>model_7_rse<span class="ot">&lt;-</span> <span class="fu">coeftest</span>(model_7, </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">vcov.=</span><span class="cf">function</span>(x)<span class="fu">vcovHC</span>(x, <span class="at">type =</span><span class="st">'sss'</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>                       )</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>model_7_rse</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
t test of coefficients:

        Estimate Std. Error t value Pr(&gt;|t|)  
post     -2.2833     1.2472 -1.8308  0.06791 .
treated   2.7500     1.3367  2.0573  0.04034 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="subject-specific-coefficients" class="level2">
<h2 class="anchored" data-anchor-id="subject-specific-coefficients">Subject-specific coefficients</h2>
<section id="random-coefficient-model-no-endogeneity" class="level3">
<h3 class="anchored" data-anchor-id="random-coefficient-model-no-endogeneity">Random-coefficient model: No endogeneity</h3>
<p>In this segment, we will use the <code>wagepan</code> data.</p>
<p>Let us fit the random-coefficient model.</p>
<div class="cell">

</div>
</section>
</section>
</section>
<section id="references" class="level1">
<h1>References</h1>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>